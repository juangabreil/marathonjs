/* marathon-js v0.0.1 - 2013/5/20
   http://github.com/juangabreil/marathonjs
   Copyright (c) 2013 Juan Gabriel Jimenez - Licensed GPLv3 */
(function(){"use strict";var t,e,s,o,r,n;r="undefined"!=typeof exports&&null!==exports?exports:this,n=function(t){var e,s,o;for(s=t.length,e=o=1;s>o;e=o+=1)t[e-1]=t[e];return t},s=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},o=function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},t={STEP_METER_VALUE:.762,stepsToMeters:function(t){return t*this.STEP_METER_VALUE},metersToSteps:function(t){return t/this.STEP_METER_VALUE}},e=function(){function t(t,e){var s,o,r;for(this._threshold=null!=t?t:.97,this._sample_before_evaluation=null!=e?e:10,this._d=[],this._n=0,s=o=0,r=this._sample_before_evaluation;r>o;s=o+=1)this._d.push(1),this._n+=s+1}var e;return t.prototype._steps=0,t.prototype._sampleCount=0,t.prototype._previousVector={x:1,y:1,z:1},t.prototype.getSteps=function(){return this._steps},e=function(t,e,s){var o,r,n;for(r=0,o=n=1;e>=n;o=n+=1)r+=o*t[o-1];return r/s},t.prototype.computeVector=function(t){return(0!==t.x||0!==t.y||0!==t.z)&&(n(this._d),this._d[this._sample_before_evaluation-1]=s(this._previousVector,t)/(o(this._previousVector)*o(t)),this._sampleCount++,this._previousVector={x:t.x,y:t.y,z:t.z}),this._sampleCount===this._sample_before_evaluation&&(this._sampleCount=0,e(this._d,this._sample_before_evaluation,this._n)<this._threshold&&this._steps++),this._steps},t.prototype.resetCounter=function(){return this._steps=0},t}(),r.Converter=t,r.Pedometer=e}).call(this);